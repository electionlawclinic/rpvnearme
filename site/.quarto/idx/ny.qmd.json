{"title":"NY","markdown":{"yaml":{"title":"NY","description":"Ecological inference estimates by county for NY\n","format":"html","server":"shiny"},"headingText":"| echo: false","containsRefs":false,"markdown":"\n\n```{r}\n#| message: false\nlibrary(tidyverse)\nlibrary(ggiraph)\nlibrary(ggdist)\nalarm_abb <- function() {\n  tibble::tribble(\n    ~a, ~b,\n    'pre', 'President',\n    'uss', 'US Senate',\n    'gov', 'Governor',\n    'atg', 'Attorney General',\n    'sos', 'Secretary of State'\n  )\n}\n\n\ncounties <- tinytiger::tt_counties('NY')\np <- counties |> \n  ggplot() +\n  geom_sf_interactive(aes(fill = 'white', color = 'black')) +\n  geom_sf_text(aes(label = NAME), fun.geometry = \\(x) geomander::st_circle_center(sf::st_as_sf(x))) +\n  theme_void() +\n  guides(fill = 'none') +\n  theme(text = element_text(family = 'Arial', size = 1))\nei_tb <- readRDS('~/GitHub/US-ei/data-out/NY_2020/NY_county_2020_ei.rds')\nei_tb <- bind_rows(lapply(ei_tb, bind_rows), .id = 'county')\n  \nei_tb <- ei_tb  |> \n  mutate(\n    race = recode(\n      race,\n      'vap_black' = 'Black',\n      'vap_hisp' = 'Hispanic',\n      'vap_oth' = 'Other',\n      'vap_white' = 'White'\n    ),\n    race = factor(race, levels = c('White', 'Black', 'Hispanic', 'Other'))\n  ) |>\n  filter(str_detect(cand, '_dem')) |>\n  mutate(election = word(cand, sep = fixed('_')),\n         election = recode(election, !!!deframe(alarm_abb())),\n         year = 2000 + as.integer(str_sub(cand, 5, 6)),\n         election = paste(election, year)) |>\n  arrange(year, election) |>\n  mutate(election = fct_inorder(election))\n```\n\n```{r}\ngirafeOutput('map')\nplotOutput('ei')\n```\n\n```{r}\n#| context: server\noutput$map <- renderGirafe({\n    girafe(ggobj = p)\n  })\noutput$ei <- renderPlot({\n  ei_tb |>\n    filter(county == map_selected) |>\n    ggplot() +\n    geom_interval(aes(y = election, x = mean, xmin = ci_95_lower, xmax = ci_95_upper, color = race),\n                  position = position_dodge(width = .5)) +\n    geom_pointinterval(aes(y = election, x = mean, xmin = mean, xmax = mean, group = race),\n                       position = position_dodge(width = .5), color = 'black') +\n    scale_x_continuous(name = 'Estimated Support for Democrats', labels = scales::percent, limits = c(0, 1)) +\n    scale_y_discrete(name = 'Contest', limits = rev) +\n    theme_bw()\n})\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"ny.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.0.36","editor":"visual","body-footer":"The TODO project is a project of the Election Law Clinic at Harvard Law School.\nElection data is originally from the [Voting and Election Science Team](https://dataverse.harvard.edu/dataverse/electionscience).\nJoined demographic and election data is used from ALARM Project's [2020 Redistricting Data Files](https://alarm-redist.github.io/posts/2021-08-10-census-2020/).\nTODO disclaimer.\n","theme":"pulse","title":"NY","description":"Ecological inference estimates by county for NY\n","server":"shiny"},"extensions":{"book":{"multiFile":true}}}}}